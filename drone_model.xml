<mujoco model="drone_with_camera">
  <compiler angle="radian" coordinate="local" inertiafromgeom="true"/>

  <option timestep="0.005" iterations="50" solver="PGS" gravity="0 0 -9.81"/>

  <asset>
    <texture name="grid" type="2d" builtin="checker" rgb1="0.1 0.1 0.1" rgb2="0.8 0.8 0.8" width="512" height="512"/>
    <material name="grid" texture="grid" texrepeat="8 8" reflectance="0.2"/>
    <texture name="sky" type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0.0 0.0 0.0" width="512" height="512"/>
    <material name="drone_mat" rgba="0.2 0.2 0.8 1"/>
    <material name="rotor_mat" rgba="0.8 0.2 0.2 1"/>
    <material name="ball_mat" rgba="1.0 0.8 0.0 1"/>
    <material name="catcher_mat" rgba="0.0 1.0 0.0 0.5"/>
  </asset>

  <worldbody>
    <!-- Ground plane -->
    <geom name="floor" pos="0 0 -0.1" size="10 10 0.1" type="box" material="grid"/>

    <!-- Lighting -->
    <light directional="true" ambient="0.2 0.2 0.2" diffuse="0.8 0.8 0.8" specular="0.3 0.3 0.3" castshadow="false" pos="0 0 20" dir="0 0 -1"/>

    <!-- Drone body -->
    <body name="drone" pos="0 0 2">
      <freejoint/>

      <!-- Central body -->
      <geom name="drone_body" type="box" size="0.2 0.2 0.05" material="drone_mat" mass="1.0"/>

      <!-- Arms -->
      <geom name="arm1" type="capsule" pos="0.15 0.15 0" size="0.02 0.1" material="drone_mat" mass="0.1"/>
      <geom name="arm2" type="capsule" pos="-0.15 0.15 0" size="0.02 0.1" material="drone_mat" mass="0.1"/>
      <geom name="arm3" type="capsule" pos="-0.15 -0.15 0" size="0.02 0.1" material="drone_mat" mass="0.1"/>
      <geom name="arm4" type="capsule" pos="0.15 -0.15 0" size="0.02 0.1" material="drone_mat" mass="0.1"/>

      <!-- Propellers -->
      <geom name="prop1" type="cylinder" pos="0.25 0.25 0.02" size="0.08 0.005" material="rotor_mat" mass="0.05"/>
      <geom name="prop2" type="cylinder" pos="-0.25 0.25 0.02" size="0.08 0.005" material="rotor_mat" mass="0.05"/>
      <geom name="prop3" type="cylinder" pos="-0.25 -0.25 0.02" size="0.08 0.005" material="rotor_mat" mass="0.05"/>
      <geom name="prop4" type="cylinder" pos="0.25 -0.25 0.02" size="0.08 0.005" material="rotor_mat" mass="0.05"/>

      <!-- Camera attachment point -->
      <body name="camera_mount" pos="0 0 -0.1">
        <geom name="camera_body" type="box" size="0.03 0.03 0.02" rgba="0.1 0.1 0.1 1" mass="0.1"/>
        <camera name="drone_camera" pos="0 0 0" xyaxes="1 0 0 0 1 0" fovy="60"/>
      </body>

      <!-- Additional cameras for different views -->
      <camera name="fpv_camera" pos="0.1 0 0" xyaxes="0 -1 0 0 0 -1" fovy="90"/>
      <camera name="top_camera" pos="0 0 0.2" xyaxes="1 0 0 0 1 0" fovy="45"/>
      <!-- Downward camera for ball detection -->
      <camera name="bottom_camera" pos="0 0 -0.15" xyaxes="1 0 0 0 -1 0" fovy="60"/>

      <!-- Sites for actuators and sensors -->
      <site name="prop1_site" pos="0.25 0.25 0.02" size="0.01"/>
      <site name="prop2_site" pos="-0.25 0.25 0.02" size="0.01"/>
      <site name="prop3_site" pos="-0.25 -0.25 0.02" size="0.01"/>
      <site name="prop4_site" pos="0.25 -0.25 0.02" size="0.01"/>
      <site name="imu_site" pos="0 0 0" size="0.01"/>
    </body>

    <!-- Falling ball -->
    <body name="ball" pos="0 0 5">
      <freejoint/>
      <geom name="ball_geom" type="sphere" size="0.1" material="ball_mat" mass="0.05" friction="0.5 0.005 0.0001"/>
      <site name="ball_site" pos="0 0 0" size="0.1"/>
    </body>

    <!-- Static camera for external view -->
    <camera name="external_camera" pos="3 3 3" xyaxes="-1 1 0 -1 -1 2" fovy="45"/>
  </worldbody>

  <actuator>
    <!-- Force actuators for thrust at propeller sites -->
    <motor name="thrust1" site="prop1_site" gear="0 0 1 0 0 0"/>
    <motor name="thrust2" site="prop2_site" gear="0 0 1 0 0 0"/>
    <motor name="thrust3" site="prop3_site" gear="0 0 1 0 0 0"/>
    <motor name="thrust4" site="prop4_site" gear="0 0 1 0 0 0"/>
  </actuator>

  <sensor>
    <!-- IMU sensors -->
    <accelerometer name="accel" site="imu_site"/>
    <gyro name="gyro" site="imu_site"/>

    <!-- Position and orientation -->
    <framepos name="drone_pos" objtype="body" objname="drone"/>
    <framequat name="drone_quat" objtype="body" objname="drone"/>

    <!-- Ball tracking sensors -->
    <framepos name="ball_pos" objtype="body" objname="ball"/>
    <framequat name="ball_quat" objtype="body" objname="ball"/>
  </sensor>
</mujoco>